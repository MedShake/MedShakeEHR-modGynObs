-- upgrade n° de version
UPDATE `system` SET `value`='v3.6.0' WHERE `name`='gynobs';


INSERT IGNORE INTO `data_cat` (`groupe`, `name`, `label`, `description`, `type`, `fromID`, `creationDate`) VALUES
('medical', 'catDataDPNI', 'Données formulaire DPNI', 'données formulaire DPNI', 'base', '1', '2019-01-01 00:00:00');

SET @catID = (SELECT data_cat.id FROM data_cat WHERE data_cat.name='catDataDPNI');
INSERT IGNORE INTO `data_types` (`groupe`, `name`, `placeholder`, `label`, `description`, `validationRules`, `validationErrorMsg`, `formType`, `formValues`, `module`, `cat`, `fromID`, `creationDate`, `durationLife`, `displayOrder`) VALUES
('medical', 'gynObsDpni1erPrelevNonInformatif', '', '1er prélèvement (ADNlc) non informatif', '1er prélèvement (ADNlc) non informatif', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniAccordCPDPN', '', 'Accord du CPDPN', 'accord du CPDPN', '', '', 'radio', '\'oui\': \'oui\'\n\'non\': \'non\'', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniAgeMatSup38AbsenceMarqueurs', '', 'Age maternel > 38 ans pour les patientes n’ayant pas pu bénéficier du dépistage par les marqueurs sériques', 'age maternel > 38 ans pour les patientes n’ayant pas pu bénéficier du dépistage par les marqueurs sériques', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniAtcdAneuploidieAutreT21', '', 'Antécédent de grossesse avec aneuploïdie autre que la trisomie 21', 'antécédent de grossesse avec aneuploïdie autre que la trisomie 21', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniAtcdGrossesseT21', '', 'Antécédent de grossesse avec trisomie 21', 'antécédent de grossesse avec trisomie 21', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniAutresMotifs', '', 'Autres motifs', 'autres motifs', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniAutresMotifsTxt', '', 'Autres motifs txt', 'autres motifs txt', '', '', 'text', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniDepistagePrimaire', '', 'Dépistage primaire', 'dépistage primaire', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniGrossesseGemellaire', '', 'Grossesse gémellaire', 'grossesse gémellaire', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniJumeauEvanes', '', 'Jumeau évanescent', 'jumeau évanescent', '', '', 'radio', '\'oui\': \'oui\'\n\'non\': \'non\'', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniNbEmbryonsEvolutifs', '1/', 'Nombre d\'embryons évolutifs', 'nombre d\'embryons évolutifs', '', '', 'number', '1', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniNuqueSupEgal3pt5mmEcho12', '', 'Nuque supérieure ou égale à 3,5mm à l\'échographie du premier trimestre', 'nuque supérieure ou égale à 3,5mm à l\'échographie du premier trimestre', '', '', 'radio', '\'oui\': \'oui\'\n\'non\': \'non\'', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniParentTranslocRobertsoChromo13', '', 'Couple dont l’un des membres est porteur d’une translocation robertsonienne impliquant un chromosome 13', 'couple dont l’un des membres est porteur d’une translocation robertsonienne impliquant un chromosome 13', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniParentTranslocRobertsoChromo21', '', 'Parent porteur d’une translocation robertsonienne impliquant le chromosome 21', 'parent porteur d’une translocation robertsonienne impliquant le chromosome 21', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniProfilAtypiqueMarqueurs', '', 'Profil atypique des marqueurs sériques maternels', 'profil atypique des marqueurs sériques maternels', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniRaisonDepMarqueursMat', '', 'Dépistage par les marqueurs sériques maternels :', 'dépistage par les marqueurs sériques maternels', '', '', 'radio', '\'1erT\': \'1er trimestre\'\n\'2eT\': \'2e trimestre\'', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniRisque', '', 'Risque', '', '', '', 'text', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniSignesEcho', 'précisez sommairement', 'Présence de signes d\'appel échographiques', 'présence de signes d\'appel échographiques', '', '', 'text', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1'),
('medical', 'gynObsDpniSouhaitParental', '', 'Souhait parental', 'souhait parental', '', '', 'checkbox', '', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '3600', '1');

SET @catID = (SELECT data_cat.id FROM data_cat WHERE data_cat.name='gynobsCatSupportDocumentsSignerObs');
INSERT IGNORE INTO `data_types` (`groupe`, `name`, `placeholder`, `label`, `description`, `validationRules`, `validationErrorMsg`, `formType`, `formValues`, `module`, `cat`, `fromID`, `creationDate`, `durationLife`, `displayOrder`) VALUES
('typecs', 'csDPNI', 'n', 'DPNI', 'support parent pour DPNI', NULL, NULL, '', 'gynObsDPNI', 'gynobs', @catID, '1', '2019-01-01 00:00:00', '84600', '1');

SET @catID = (SELECT forms_cat.id FROM forms_cat WHERE forms_cat.name='formsProdOrdoEtDoc');
INSERT IGNORE INTO `forms` (`module`, `internalName`, `name`, `description`, `dataset`, `groupe`, `formMethod`, `formAction`, `cat`, `type`, `yamlStructure`, `options`, `printModel`, `cda`, `javascript`) VALUES
('gynobs', 'gynObsDPNI', 'DPNI', 'DPNI', 'data_types', 'medical', 'post', '/patient/ajax/saveCsForm/', @catID, 'public', 'structure:\r\n  row1:\r\n    head: \'DPNI\'\r\n    col1:\r\n      head: \'Renseignements cliniques\'\r\n      size: col-8	\r\n      bloc:\r\n        - gynObsDpniNbEmbryonsEvolutifs,class={w-25} 		#1780 Nombre d embryons évolutifs\n        - gynObsDpniJumeauEvanes                   		#1781 Jumeau évanescent\n        - gynObsDpniNuqueSupEgal3pt5mmEcho12       		#1782 Nuque supérieure ou égale à 3,5mm à l échographie du premier trimestre\n  row2:\r\n    col1:\r\n      size: col-9	\r\n      bloc:\r\n        - gynObsDpniSignesEcho                     		#1784 Présence de signes d appel échographiques\n    col2:\r\n      size: col-3	\r\n      bloc:\r\n        - gynObsDpniAccordCPDPN,classLabel={brAfter} 		#1783 Accord du CPDPN\n\r\n  row3:\r\n    col1:\r\n      head: \'Motif de prescription\'\r\n      size: col-auto	\r\n      bloc:\r\n        - label{REMBOURSÉ :},class={font-weight-bold}		\n\r\n  row4:\r\n    col1:\r\n      size: col-auto	\r\n      bloc:\r\n        - gynObsDpniRaisonDepMarqueursMat          		#1766 Dépistage par les marqueurs sériques maternels :\n  row5:\r\n    col1:\r\n      size: col-2	\r\n      bloc:\r\n        - gynObsDpniRisque,nolabel,plusg={Risque 1/} 		#1779 Risque\n\r\n  row6:\r\n    col1:\r\n      size: col-auto	\r\n      bloc:\r\n        - gynObsDpniGrossesseGemellaire            		#1769 Grossesse gémellaire\n        - gynObsDpniAtcdGrossesseT21               		#1770 Antécédent de grossesse avec trisomie 21\n        - gynObsDpniParentTranslocRobertsoChromo21 		#1771 Parent porteur d’une translocation robertsonienne impliquant le chromosome 21\n        - gynObsDpni1erPrelevNonInformatif         		#1772 1er prélèvement (ADNlc) non informatif\n        - label{NON REMBOURSÉ :},class={font-weight-bold}		\n        - gynObsDpniSouhaitParental                		#1773 Souhait parental\n        - gynObsDpniDepistagePrimaire              		#1774 Dépistage primaire\n        - gynObsDpniAgeMatSup38AbsenceMarqueurs    		#1775 Age maternel > 38 ans pour les patientes n’ayant pas pu bénéficier du dépistage par les marqueurs sériques\n        - gynObsDpniParentTranslocRobertsoChromo13 		#1776 Couple dont l’un des membres est porteur d’une translocation robertsonienne impliquant un chromosome 13\n        - gynObsDpniAtcdAneuploidieAutreT21        		#1777 Antécédent de grossesse avec aneuploïdie autre que la trisomie 21\n        - gynObsDpniProfilAtypiqueMarqueurs        		#1778 Profil atypique des marqueurs sériques maternels\n\r\n  row7:\r\n    col1:\r\n      size: col-auto	\r\n      bloc:\r\n        - gynObsDpniAutresMotifs                   		#1785 Autres motifs\n    col2:\r\n      size: col-10	\r\n      bloc:\r\n        - gynObsDpniAutresMotifsTxt,nolabel        		#1786 Autres motifs txt', '# NB : Ces options sont à adapter à chaque installation !\r\n# Elles correspondent en l\'état à l\'utilisation des formulaires Ninalia Eurofins Biomnis en impression recto verso:\r\n# - B39 version mai 2019 en page 1\r\n# - D39 version janvier 2019 en page 3 et 4\r\n# à concaténer dans un document DPNIrv.pdf NON FOURNI (page 2 blanche)\r\n#\r\n# Le modèle DPNI.html.twig est fourni et correspond à l\'ordonnance pour prélèvement qui est concaténée en fin (page 5).   \r\n#\r\n# fichiers tampon.png et signature.png sont à implémenter pour chaque utilisateur (cf. documentation)\r\n\r\noptionsPdf:\r\n  onSave:\r\n    optimizeWithGS: true\r\n  templatePdf:\r\n    source: \'/path/to/templates/PDF/DPNIrv.pdf\'\r\n    mode: \'concat\'  \r\n    defautFont: \'Arial\'\r\n    defautFontSize: 9\r\n    defautTextColor: \'0,0,0\'\r\n    pagesImgMapping: \r\n      page1:\r\n        \'tampon.png\': [155, 48, 45, 0, \'PNG\'] \r\n        \'signature.png\': [168, 73, 30, 0, \'PNG\'] \r\n      page4:\r\n        \'tampon.png\': [60, 240, 45, 0, \'PNG\']\r\n        \'signature.png\': [35, 240, 30, 0, \'PNG\']\r\n    pagesTxtMapping:\r\n      page1: \r\n        lastname: [20, 56]\r\n        birthname: [42, 62]\r\n        firstname: [25, 67]\r\n        birthdate: [42, 73]\r\n        adressePersoLigne1: [9, 83.5]\r\n        postalCodePerso: [18, 89]\r\n        city: [9, 94]\r\n        dateDD: [145, 42.5, 16]\r\n        dateMM: [155, 42.5, 16]\r\n        dateYYYY: [166, 42.5, 16]\r\n        AuteurInitial_nomUsuel: [117, 56] \r\n        AuteurInitial_firstname: [124, 62]\r\n        AuteurInitial_adresseProLigne1: [124, 67]\r\n        AuteurInitial_codePostalPro: [117, 73]\r\n        AuteurInitial_villeAdressePro: [117, 78]\r\n        AuteurInitial_telPro: [117, 83.5]\r\n        AuteurInitial_faxPro: [117, 88.5]\r\n        AuteurInitial_emailApicrypt: [119, 94.5, 8]\r\n        ddgReel: [58, 109]\r\n        gynObsDpniNbEmbryonsEvolutifs: [58, 114]\r\n        gynObsDpniJumeauEvanes:\r\n          oui: [146, 115, \'\', \'\', \'\', \'X\']\r\n          non: [166, 115, \'\', \'\', \'\', \'X\']\r\n        gynObsDpniNuqueSupEgal3pt5mmEcho12:\r\n          oui: [146, 119, \'\', \'\', \'\', \'X\']\r\n          non: [166, 119, \'\', \'\', \'\', \'X\']\r\n        gynObsDpniSignesEcho: [98, 123.5, 8]\r\n        gynObsDpniAccordCPDPN:\r\n          oui: [146, 129, \'\', \'\', \'\', \'X\']\r\n          non: [166, 129, \'\', \'\', \'\', \'X\']  \r\n        gynObsDpniRaisonDepMarqueursMat: \r\n          1erT:\r\n            - [15, 142, \'\', \'\', \'\', \'X\']\r\n            - [98, 142, \'\', \'\', \'\', \'X\']\r\n          2eT:\r\n            - [15, 142, \'\', \'\', \'\', \'X\']\r\n            - [129, 142, \'\', \'\', \'\', \'X\']\r\n        gynObsDpniRisque: [35,146]\r\n        gynObsDpniGrossesseGemellaire:\r\n          true: [15, 150.5, \'\', \'\', \'\', \'X\']\r\n        gynObsDpniAtcdGrossesseT21:\r\n          true: [15, 155, \'\', \'\', \'\', \'X\']          \r\n        gynObsDpniParentTranslocRobertsoChromo21: 		\r\n          true: [15, 159, \'\', \'\', \'\', \'X\'] \r\n        gynObsDpni1erPrelevNonInformatif:\r\n          true: [15, 164, \'\', \'\', \'\', \'X\']         \r\n        gynObsDpniSouhaitParental:         \r\n          true: [15, 173, \'\', \'\', \'\', \'X\']         \r\n        gynObsDpniDepistagePrimaire:       \r\n          true: [15, 177, \'\', \'\', \'\', \'X\']         \r\n        gynObsDpniAgeMatSup38AbsenceMarqueurs:\r\n          true: [15, 181, \'\', \'\', \'\', \'X\']         \r\n        gynObsDpniParentTranslocRobertsoChromo13:\r\n          true: [15, 185, \'\', \'\', \'\', \'X\']         \r\n        gynObsDpniAtcdAneuploidieAutreT21:\r\n          true: [15, 190, \'\', \'\', \'\', \'X\']         \r\n        gynObsDpniProfilAtypiqueMarqueurs:\r\n          true: [15, 194, \'\', \'\', \'\', \'X\']       \r\n        gynObsDpniAutresMotifs:\r\n          true: [15, 198, \'\', \'\', \'\', \'X\']\r\n        gynObsDpniAutresMotifsTxt: [32.5, 197.5]\r\n      page4:\r\n        identiteCompleteTitreCourt: [39, 66, 8] \r\n        AuteurInitial_identiteUsuelleTitre: \r\n          - [40, 77, 8]\r\n          - [16, 253, 6]\r\n        dateDD: \r\n          - [80, 82]\r\n          - [27, 232]\r\n        dateMM: \r\n          - [90, 82]\r\n          - [37, 232]\r\n        dateYYYY: \r\n          - [100, 82]\r\n          - [47, 232]  \r\n        identiteCompleteTitreLongDdn: [109, 253, 6]', 'DPNI', '', '');
